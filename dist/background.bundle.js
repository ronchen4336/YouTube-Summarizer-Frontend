chrome.action.onClicked.addListener((e=>{e.url&&e.url.includes("youtube.com/watch")?chrome.tabs.sendMessage(e.id,{action:"trigger_summarize"}):chrome.scripting.executeScript({target:{tabId:e.id},func:()=>{alert("Please navigate to a YouTube video page to use this extension.")}})})),chrome.runtime.onMessage.addListener(((e,o,r)=>{if("getYouTubeVideo"===e.action)try{const o=e.videoUrl;return chrome.cookies.getAll({domain:".youtube.com"},(e=>{const t=e.map((e=>`${e.name}=${e.value}`)).join("; ");fetch("https://youtube-summarizer-445521.appspot.com/summarize",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoUrl:o,cookies:t})}).then((e=>{if(!e.ok)throw new Error(`Server responded with ${e.status}`);return e.json()})).then((e=>{r({success:!0,data:e})})).catch((e=>{console.error("API request failed:",e),r({success:!1,error:e.message})}))})),!0}catch(e){return console.error("Error processing video:",e),r({success:!1,error:e.message}),!0}}));